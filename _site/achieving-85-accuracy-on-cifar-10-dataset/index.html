<!DOCTYPE html>
<html lang="en-US">
   <head>
 <!--  <meta property="og:locale" content="en_US"> -->
<!-- favicons -->
<!-- <link rel="shortcut icon" href="/assets/images/iconified/apple-touch-icon.png" type="image/x-icon" /> -->
  <!-- Hotjar Tracking Code for https://cheloverboard.netlify.com/ -->
 <meta itemprop="description" name="description" content="Learn how to build an Image Classification Model, Export as an API that can be deployed as back-end to a Web Application for Classification problems. In this..." />
 <meta content="width=device-width, initial-scale=1" name="viewport">
 <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Achieving 85% Accuracy in Image Classification task on Cifar10 Dataset with Keras Convolutional Neural Networks</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Achieving 85% Accuracy in Image Classification task on Cifar10 Dataset with Keras Convolutional Neural Networks" />
<meta name="author" content="Chel" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Learn how to build an Image Classification Model, Export as an API that can be deployed as back-end to a Web Application for Classification problems. In this tutuorial we go over all the steps required to build an Image Classify using the popular Cifar 10 and Cifar 100 datasets." />
<meta property="og:description" content="Learn how to build an Image Classification Model, Export as an API that can be deployed as back-end to a Web Application for Classification problems. In this tutuorial we go over all the steps required to build an Image Classify using the popular Cifar 10 and Cifar 100 datasets." />
<link rel="canonical" href="https://channelai.netlify.app/achieving-85-accuracy-on-cifar-10-dataset/" />
<meta property="og:url" content="https://channelai.netlify.app/achieving-85-accuracy-on-cifar-10-dataset/" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-11T00:00:00+01:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"https://channelai.netlify.app/achieving-85-accuracy-on-cifar-10-dataset/","headline":"Achieving 85% Accuracy in Image Classification task on Cifar10 Dataset with Keras Convolutional Neural Networks","dateModified":"2020-07-11T00:00:00+01:00","datePublished":"2020-07-11T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://channelai.netlify.app/achieving-85-accuracy-on-cifar-10-dataset/"},"author":{"@type":"Person","name":"Chel"},"description":"Learn how to build an Image Classification Model, Export as an API that can be deployed as back-end to a Web Application for Classification problems. In this tutuorial we go over all the steps required to build an Image Classify using the popular Cifar 10 and Cifar 100 datasets.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

 <meta charset="utf-8">
 <title>Achieving 85% Accuracy in Image Classification task on Cifar10 Dataset with Keras Convolutional Neural Networks</title>
 <style type="text/css">body{color:#202020}</style>
 <link rel="stylesheet" href="/assets/css/packages/styles/default.css">
 <script src="/assets/css/packages/highlight.pack.js"></script>
 <script>hljs.initHighlightingOnLoad();</script>
 <link rel="stylesheet" href="/assets/css/styles.css" onload="this.media='all'; this.onload=null;>
//<script async>
//     (function(h,o,t,j,a,r){
//         h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
//         h._hjSettings={hjid:1694485,hjsv:6};
//         a=o.getElementsByTagName('head')[0];
//         r=o.createElement('script');r.async=1;
//         r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
//         a.appendChild(r);
//     })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
// </script>

 <meta name="google-site-verification" content="1LO3TSIxeeNWjGMHqMznkmBaXeBmBpBZDqdsuM5Np-U"/>
  <!-- Google Adsense Code -->
  <script data-ad-client="ca-pub-6920696800834585" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- End Of Adsense Code -->
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-custom">
  
  <!-- Navbar Brand -->
  <a class="navbar-brand" href="/"><img src="/assets/images/CHANNEL AI_free-file (1).webp" width="80" height="80" alt="ChannelAI"></a>
  
  <!-- Collapse button --> 
  <button class="navbar-toggler dropdown-toggle-align" type="button" data-toggle="collapse" data-target="#basicExampleNav" aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"><i style="font-size: 24px; margin-left: -5px;" class="fas fa-align-left"></i></span>
  </button>
  
  <!-- Collapsible content -->
  <div class="collapse navbar-collapse" id="basicExampleNav" style="color:black;">
 
  	<!-- Links -->
    <ul class="navbar-nav mr-auto waves-effect waves-light">
      
      <a class="nav-item nav-link" href="/">HOME</a>
      
      <a class="nav-item nav-link" href="/blog/">BLOG</a>
      
      <a class="nav-item nav-link" href="/resources/">RESOURCES</a>
      
      <a class="nav-item nav-link" href="/portfolio/">PORTFOLIO</a>
      
      <a class="nav-item nav-link" href="/staff/">STAFF</a>
      
      <a class="nav-item nav-link" href="/about/">ABOUT</a>
      
    </ul>
    </div>
</nav>
    <!--  Main Container    -->
   <div class="container blog-container">
      
<!--   Beginning of Row   -->
     <div class="row">
<!--      Column   -->
      <div class="col-md-10 col-sm-12">
       <h1 class="post-header">Achieving 85% Accuracy in Image Classification task on Cifar10 Dataset with Keras Convolutional Neural Networks</h1>

		<p>
			Jul 11, 2020
  			
  			
  			- <a href="/authors/jill/">Chelsea Ash</a><p style="clear: left;">
  			<img src="../assets\images\Blog\generative-nets.webp" class="img-fluid" alt="Responsive image"/>
			</p>
			<br>

            <p>In this tutorial you would learn some methods that can be used to improve a model’s accuracy. This can be achieved in a few lines of code using Tensorflow by just importing required libraries. If you haven’t already, you can build a Tensorflow Image Classification model following the guide in the last post <a href="">How to Build an Image Classification API in Tensorflow</a>. This is an overview of what we would be touching on in this tutorial:</p>

<h3>Overview</h3>
<ul>
  <li>Improving Model’s Accuracy</li>
  <li>Dropouts: Understanding how it reduces Overfitting</li>
  <li>Batch Normalization</li>
  <li>Buiding a Cifar10 Model with 85% Accuracy</li>
</ul>

<p>Previous: <a href="">How to Build an Image Classification API in Tensorflow</a></p>

<p>Next: <a href="">Building an Image Classification API with TFX and GCP </a></p>

<h3>Improving Model's Accuracy</h3>

<p>In the last article we built a simple classifier model in Tensorflow. I achieved 75% accuracy after evaluating the test set which consists of 10000 Images which was not used in training. This gives us a view of how our model would perform in a real world scenario. Of-course, we aren’t going to use this model for any big projects anytime soon, but by practising on it gives us understanding that can be applied to bigger projects.</p>

<p>Not all model’s after training can be significantly improved by applying this methods. It could be that the achitecture used at first didn’t train the model in the right way. In this case, you would need to change the layers used before getting any significant improvements. A very good way of knowing if a model can be improved is by plotting learning curves. This can be done in tensorflow in just a few lines of code.</p>

<p><img src="/assets/images/Blog/Blog-img/learning-curves-cifar10-dataset.webp" class="img-fluid" alt="Learning Curves Of Cifar10" width="100%" height="60vh" />
As seen in the image above, around epochs 14, the validation set curve (orange) can be seen to have a strong dip. This tells us that if we increase the number of epochs or add regularization techniques like Dropouts and BatchNormalization, we can achieve better accuracy</p>

<p>In this tutorial, we would look at some established methods of reducing overfitting and slowing-down convergence in our model which in turn gives us better accuracy. Let’s look at them now.</p>

<h3>Dropouts</h3>
<p><b>Dropout</b> is a technique for addressing overfitting. The main idea here is for our neural network to randomly drop units during training. The reduction inparameters in each step of training has effect of regularization. Dropout has shown improvements in the performance of neural networks on supervised learning tasks in vision, speech recognition, document classification and computational biology, obtaining state-of-the-art results on many benchmark data sets.</p>

<h3>BatchNormalization</h3>
<p><b>BatchNormalization</b> normalizes the activation of the previous layer at each batch, i.e. applies a transformation that maintains the mean activation close to 0 and the activation standard deviation close to 1. It addresses the problem of internal covariate shift. It also acts as a regularizer, in some cases eliminating the need for Dropout. Batch Normalization achieves the same accuracy with fewer training steps thus speeding up the training process. This definition is cited from <a href="https://appliedmachinelearning.blog/2018/03/24/achieving-90-accuracy-in-object-recognition-task-on-cifar-10-dataset-with-keras-convolutional-neural-networks/">appliedmachinelearning.blog</a></p>

<p>Now that we understand the technique that would be applied during training to improve accuracy, let’s see how to implement it in code.</p>

<h3>Buiding a Cifar10 Model with 85% Accuracy</h3>

<p>Below is the code that introduces batch normalization and dropouts to our model’s ConvNet. For the full code including loading the dataset and normalizing it, refer to my github repo here <a href="">Image Classification with Cifar10 (Full) </a></p>

<pre><code>
from keras.models import Sequential
from keras.optimizers import SGD
from keras.preprocessing.image import ImageDataGenerator
from keras.layers import BatchNormalization
from keras import regularizers
from keras.callbacks import LearningRateScheduler
from keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPooling2D

model = Sequential()
model.add(Conv2D(32, (3, 3), activation='relu', padding='same', input_shape=(32, 32, 3))),
model.add(Conv2D(32, (3, 3), activation='relu', padding='same'))
model.add(MaxPooling2D(2, 2)),
model.add(Dropout(0.2))
model.add(Conv2D(64, (3, 3), activation='relu', padding='same')),
model.add(Conv2D(64, (3, 3), activation='relu', padding='same')),
model.add(MaxPooling2D(2, 2)),
model.add(Dropout(0.2))
model.add(Conv2D(128, (3, 3), activation='relu', padding='same')),
model.add(Conv2D(128, (3, 3), activation='relu', padding='same')),
model.add(MaxPooling2D(2, 2)),
model.add(Dropout(0.2))
model.add(Flatten()),
model.add(Dense(512, activation='relu')),
model.add(Dropout(0.5))
model.add(Dense(10, activation='softmax'))

model.summary()

model.compile(loss='categorical_crossentropy',
              optimizer='adam',
              metrics=['accuracy'])

hist = model.fit(x_train, y_train_one_hot, 
          batch_size=64, epochs=25, 
           validation_split=0.2, verbose=1)
</code></pre>

<p>The output of the above code implementation for Image classification task is shown below:</p>

<p><img src="" /></p>

<p>Here, we trained our model for just 25% accuracy and achieved approx 85% accuracy. This is a significant development from when we only convolution and maxpooling layers to build our model. Training it for more epochs can as well give you more accuracy which you should try out by simply following the guide.</p>

        </div>
        <!-- End of Column -->
     </div>
     <!-- End of Row -->
 </div>
 <!-- End of Main Container -->
    <!-- Footer -->
<footer class="page-footer font-small">

  <!-- Footer Elements -->
  <div class="container-fluid footer-style">

    <!--Grid row-->
    <div class="row">

      <!--Grid column-->
      <div class="col-md-6 mb-4">

        <!-- Form -->
        <form class="form-inline">
          <input class="form-control form-control-sm mr-3 w-75" type="text" placeholder="Search"
            aria-label="Search">
          <a class="btn-floating btn-sm btn-secondary" aria-hidden="true"><i class="fas fa-search"></i></a>
        </form>
        <!-- Form -->

      </div>
      <!--Grid column-->

      <!--Grid column-->
      <div class="col-md-6 mb-4">

        <form class="input-group">
          <input type="text" class="form-control form-control-sm" placeholder="Your email"
            aria-label="Your email" aria-describedby="basic-addon2">
          <div class="input-group-append">
            <button class="btn btn-sm signup-footer" type="button">SIGN UP</button>
          </div>
        </form>

      </div>
      <!--Grid column-->

    </div>
    <!--Grid row-->

  </div>
  <!-- Footer Elements -->

  <!-- Copyright -->
  <div class="footer-copyright text-center py-3 copyright">© 2020 Copyright:
    <a href="https://channelai.netlify.app/" class="site-n-privacy"> Channelai.com</a> |
    <a href="https://channelai.netlify.app/privacy/" class="site-n-privacy"> Privacy</a>
    <a href="http://channelai.netlify.app/sitemap.xml">Sitemap</a>
  </div>
  <!-- Copyright -->

</footer>
<!-- Footer -->
 <script defer src="https://use.fontawesome.com/releases/v5.13.0/js/all.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
  </body>
</html>

<!-- <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>Achieving 85% Accuracy in Image Classification task on Cifar10 Dataset with Keras Convolutional Neural Networks - </title>
    <link rel="stylesheet" href="/assets/css/styles.css">
  </head> -->